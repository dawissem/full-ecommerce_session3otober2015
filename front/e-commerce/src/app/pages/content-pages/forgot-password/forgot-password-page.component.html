<!--Forgot Password Page Starts-->
<section id="forgot-password">
  <div class="row auth-height full-height-vh m-0">
    <div class="col-12 d-flex align-items-center justify-content-center">
      <div class="card overflow-hidden">
        <div class="card-content">
          <div class="card-body auth-img">
            <div class="row m-0">
              <div class="col-lg-6 d-none d-lg-flex justify-content-center align-items-center text-center auth-img-bg p-3">
                <img src="assets/img/gallery/forgot.png" alt="" class="img-fluid" width="300" height="230">
              </div>
              <div class="col-lg-6 col-md-12 px-4 py-3">
                <h4 class="mb-2 card-title">Reset Password</h4>
                <p *ngIf="step === 'email'">Enter your email to receive OTP.</p>
                <p *ngIf="step === 'otp'">Enter the OTP sent to your email.</p>
                <p *ngIf="step === 'reset'">Enter your new password.</p>

                <!-- Success Message -->
                <ngb-alert type="light-success" class="mb-2" *ngIf="successMessage" [dismissible]="false">
                  <p class="mb-0">{{ successMessage }}</p>
                </ngb-alert>

                <!-- Error Message -->
                <ngb-alert type="light-danger" class="mb-2" *ngIf="errorMessage" (close)="errorMessage = ''">
                  <p class="mb-0">{{ errorMessage }}</p>
                </ngb-alert>

                <!-- Step 1: Email Form -->
                <form [formGroup]="emailForm" *ngIf="step === 'email'">
                  <div class="form-group">
                    <input type="email" formControlName="email" class="form-control" placeholder="Email"
                      [ngClass]="{ 'is-invalid': emailFormSubmitted && ef.email.invalid, 'is-valid': emailFormSubmitted && !ef.email.invalid }"
                      required>
                    <div *ngIf="emailFormSubmitted && ef.email.errors?.required"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> Email is required
                    </div>
                    <div *ngIf="emailFormSubmitted && ef.email.errors?.email"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> Please enter a valid email
                    </div>
                  </div>
                  <div class="d-flex justify-content-between flex-sm-row flex-column">
                    <a (click)="onLogin()" class="btn bg-light-primary mb-2 mb-sm-0">Back To Login</a>
                    <a class="btn btn-primary" (click)="onSubmitEmail()">Send OTP</a>
                  </div>
                </form>

                <!-- Step 2: OTP Form -->
                <form [formGroup]="otpForm" *ngIf="step === 'otp'">
                  <div class="form-group">
                    <input type="text" formControlName="otp" class="form-control" placeholder="Enter 6-digit OTP"
                      [ngClass]="{ 'is-invalid': otpFormSubmitted && of.otp.invalid, 'is-valid': otpFormSubmitted && !of.otp.invalid }"
                      maxlength="6" required>
                    <div *ngIf="otpFormSubmitted && of.otp.errors?.required"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> OTP is required
                    </div>
                    <div *ngIf="otpFormSubmitted && of.otp.errors?.minlength"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> OTP must be 6 digits
                    </div>
                  </div>
                  <div class="d-flex justify-content-between mb-2">
                    <a (click)="onResendOTP()" class="text-primary cursor-pointer">Resend OTP</a>
                  </div>
                  <div class="d-flex justify-content-between flex-sm-row flex-column">
                    <a (click)="step = 'email'" class="btn bg-light-primary mb-2 mb-sm-0">Back</a>
                    <a class="btn btn-primary" (click)="onSubmitOTP()">Verify OTP</a>
                  </div>
                </form>

                <!-- Step 3: Reset Password Form -->
                <form [formGroup]="resetForm" *ngIf="step === 'reset'">
                  <div class="form-group">
                    <input type="password" formControlName="newPassword" class="form-control" placeholder="New Password"
                      [ngClass]="{ 'is-invalid': resetFormSubmitted && rf.newPassword.invalid, 'is-valid': resetFormSubmitted && !rf.newPassword.invalid }"
                      required>
                    <div *ngIf="resetFormSubmitted && rf.newPassword.errors?.required"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> Password is required
                    </div>
                    <div *ngIf="resetFormSubmitted && rf.newPassword.errors?.minlength"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> Password must be at least 6 characters
                    </div>
                  </div>
                  <div class="form-group">
                    <input type="password" formControlName="confirmPassword" class="form-control" placeholder="Confirm Password"
                      [ngClass]="{ 'is-invalid': resetFormSubmitted && rf.confirmPassword.invalid, 'is-valid': resetFormSubmitted && !rf.confirmPassword.invalid }"
                      required>
                    <div *ngIf="resetFormSubmitted && rf.confirmPassword.errors?.required"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> Confirm password is required
                    </div>
                    <div *ngIf="resetFormSubmitted && rf.confirmPassword.errors?.passwordMismatch"
                      class="help-block mt-1 text-danger">
                      <i class="ft-alert-circle align-middle"></i> Passwords do not match
                    </div>
                  </div>
                  <div class="d-flex justify-content-between flex-sm-row flex-column">
                    <a (click)="onLogin()" class="btn bg-light-primary mb-2 mb-sm-0">Back To Login</a>
                    <a class="btn btn-primary" (click)="onSubmitReset()">Reset Password</a>
                  </div>
                </form>

                <hr>
                <div class="text-center">
                  <p class="card-text mb-0">Don't have an account? <a (click)="onRegister()" class="text-primary cursor-pointer">Register</a></p>
                </div>
                <ngx-spinner></ngx-spinner>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!--Forgot Password Page Ends-->
