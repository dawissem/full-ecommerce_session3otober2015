<!-- OTP Verification Page -->
<section id="otp-verification">
  <div class="row auth-height full-height-vh m-0">
    <div class="col-12 d-flex align-items-center justify-content-center">
      <div class="card overflow-hidden">
        <div class="card-content">
          <div class="card-body auth-img">
            <div class="row m-0">
              <div class="col-lg-6 d-none d-lg-flex justify-content-center align-items-center text-center auth-img-bg py-2">
                <img src="assets/img/gallery/otp.png" alt="OTP Verification" class="img-fluid" width="300">
              </div>
              <div class="col-lg-6 col-md-12 px-4 py-3">
                <h4 class="card-title mb-2">Verify Your Email</h4>
                <p class="mb-3">We've sent a 6-digit verification code to<br><strong>{{ email }}</strong></p>

                <!-- Success Alert -->
                <ngb-alert type="light-success" class="mb-3" *ngIf="successMessage" [dismissible]="false">
                  <div class="d-flex align-items-center">
                    <i class="ft-check-circle mr-2"></i>
                    <p class="mb-0">{{ successMessage }}</p>
                  </div>
                </ngb-alert>

                <!-- Error Alert -->
                <ngb-alert type="light-danger" class="mb-3" *ngIf="errorMessage" (close)="errorMessage = ''">
                  <div class="d-flex align-items-center">
                    <i class="ft-alert-circle mr-2"></i>
                    <p class="mb-0">{{ errorMessage }}</p>
                  </div>
                </ngb-alert>

                <!-- OTP Input -->
                <div class="otp-container mb-4">
                  <div class="d-flex justify-content-between otp-inputs">
                    <div class="otp-box" *ngFor="let digit of otpDigits; let i = index">
                      <input
                        type="text"
                        maxlength="1"
                        class="form-control otp-input text-center"
                        [(ngModel)]="otpDigits[i]"
                        (input)="onOtpDigitInput($event, i)"
                        (keydown)="onOtpDigitKeyDown($event, i)"
                        (paste)="onOtpDigitPaste($event)"
                        [attr.data-index]="i"
                        autocomplete="off"
                      />
                    </div>
                  </div>
                </div>

                <!-- Action Buttons -->
                <div class="d-flex flex-column">
                  <button 
                    type="button" 
                    class="btn btn-primary btn-block mb-3" 
                    (click)="verifyOtp()"
                    [disabled]="otpDigits.join('').length !== 6">
                    <i class="ft-check mr-1"></i> Verify Email
                  </button>

                  <div class="text-center mb-3">
                    <p class="mb-0">
                      Didn't receive the code?
                      <a 
                        href="javascript:void(0)" 
                        class="ml-1" 
                        [class.text-muted]="resendDisabled"
                        [class.font-weight-bold]="!resendDisabled"
                        (click)="resendOtp()">
                        <span *ngIf="resendDisabled">
                          Resend in {{ resendCountdown }}s
                        </span>
                        <span *ngIf="!resendDisabled">
                          Resend OTP
                        </span>
                      </a>
                    </p>
                  </div>

                  <button 
                    type="button" 
                    class="btn btn-outline-secondary btn-block" 
                    (click)="cancelVerification()">
                    <i class="ft-arrow-left mr-1"></i> Back to Login
                  </button>
                </div>

                <!-- Info Box -->
                <div class="alert alert-light-info mt-4" role="alert">
                  <div class="d-flex align-items-start">
                    <i class="ft-info mr-2 mt-1"></i>
                    <div>
                      <p class="mb-1 font-weight-bold">Security Tip</p>
                      <small>Never share your OTP code with anyone. Our team will never ask for your OTP.</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<ngx-spinner></ngx-spinner>
